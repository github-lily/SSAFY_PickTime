# ğŸ”¹ 1ë‹¨ê³„: ë¹Œë“œìš© ì´ë¯¸ì§€ (Gradle ì‚¬ìš©í•˜ì—¬ JAR ë¹Œë“œ)
FROM openjdk:17-jdk-alpine AS builder

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# Gradle Wrapper ë° í”„ë¡œì íŠ¸ ì„¤ì • íŒŒì¼ ë³µì‚¬
COPY gradlew gradlew
COPY gradle gradle
COPY build.gradle build.gradle
COPY settings.gradle settings.gradle

# ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY src src

# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬ ë° ë¹Œë“œ ìˆ˜í–‰
RUN chmod +x gradlew
RUN ./gradlew clean bootJar

# ğŸ”¹ 2ë‹¨ê³„: ì‹¤í–‰ìš© ì´ë¯¸ì§€ (Spring Boot ì‹¤í–‰ í™˜ê²½)
FROM openjdk:17-jdk-alpine

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# ë¹Œë“œëœ JAR íŒŒì¼ ë³µì‚¬
COPY --from=builder /app/build/libs/*.jar app.jar

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
ENTRYPOINT ["java", "-jar", "/app.jar"]
